version: 2

models:
  - name: raw_sales_data
    description: |
      Staging model for sales data sourced from the bronze layer.
      Standardizes column names, casts data types, parses order_date

      Grain: one row per (order_id, product_id) sales line item.

    columns:
      - name: sales_uuid
        description: |
          Surrogate identifier for each sales line item, generated deterministically
          from (order_id, product_id) using stable_uuid.
        tests:
          - not_null
          - unique

      - name: order_id
        description: |
          Order business key. Multiple products can belong to the same order
          (multiple rows per order_id).
        tests:
          - not_null

      - name: customer_id
        description: "Customer business key identifying who placed the order."
        tests:
          - not_null

      - name: product_id
        description: "Product business key identifying which product was sold."
        tests:
          - not_null

      - name: product_name
        description: "Human-readable product name associated with product_id."
        tests:
          - not_null

      - name: quantity
        description: "Number of units sold for this order line item."
        tests:
          - not_null
          - expression_is_true:
              expression: "quantity > 0"

      - name: price
        description: "Unit price of the product at the time of the transaction."
        tests:
          - not_null
          - expression_is_true:
              expression: "price > 0"

      - name: order_status
        description: |
          Status of the order (e.g., Completed, Pending, Cancelled).
          Used downstream to filter/aggregate completed orders.
        tests:
          - not_null
          - accepted_values:
              values: ['Completed', 'Pending', 'Cancelled']

      - name: order_date
        description: |
          Parsed order date (try_to_date(order_date,'MM/DD/YYYY')).
          Used for time-based analysis and joins to the date dimension.
        tests:
          - not_null

  - name: raw_customer_data
    description: |
      Staging model for customer data sourced from the bronze layer.
      Standardizes and casts customer fields and adds ingestion metadata.

      Grain: one row per customer_id.

    columns:
      - name: customer_id
        description: "Customer business key (cast from source column id)."
        tests:
          - not_null
          - unique

      - name: customer_name
        description: "Customer display name (cast from source column name)."
        tests:
          - not_null
